{
  "version": 3,
  "sources": ["../src/index.tsx", "../src/hooks/use-interval.tsx"],
  "sourcesContent": ["import { Action, ActionPanel, clearSearchBar, getPreferenceValues, Icon, List, showHUD } from \"@raycast/api\";\nimport { exec } from \"child_process\";\nimport { useState } from \"react\";\nimport useInterval from \"./hooks/use-interval\";\n\nexport default function ProcessList() {\n  const [state, setState] = useState<Process[]>([]);\n  const [query, setQuery] = useState<string | undefined>(undefined);\n\n  const preferences = getPreferenceValues<Preferences>();\n  const shouldIncludePaths = preferences.shouldSearchInPaths ?? false;\n  const shouldIncludePid = preferences.shouldSearchInPid ?? false;\n  const shouldPrioritizeAppsWhenFiltering = preferences.shouldPrioritizeAppsWhenFiltering ?? false;\n  const shouldShowPID = preferences.shouldShowPID ?? false;\n  const shouldShowPath = preferences.shouldShowPath ?? false;\n  const refreshDuration = +preferences.refreshDuration;\n\n  const fetchProcesses = () => {\n    exec(`ps -eo pid,pcpu,comm | sort -nrk 2,3`, (err, stdout) => {\n      if (err != null) {\n        return;\n      }\n\n      const processes = stdout\n        .split(\"\\n\")\n        .map((line) => {\n          const [, id, cpu, path] = line.match(/(\\d+)\\s+(\\d+[.|,]\\d+)\\s+(.*)/) ?? [\"\", \"\", \"\", \"\"];\n          const name = path.match(/[^/]*[^/]*$/i)?.[0] ?? \"\";\n          const isPrefPane = path.includes(\".prefPane\");\n          const isApp = path.includes(\".app\");\n\n          return {\n            id,\n            cpu,\n            path,\n            name,\n            type: isPrefPane ? \"prefPane\" : isApp ? \"app\" : \"binary\",\n          } as Process;\n        })\n        .filter((process) => process.name !== \"\");\n\n      setState(processes);\n    });\n  };\n\n  useInterval(fetchProcesses, refreshDuration);\n\n  const fileIcon = (process: Process) => {\n    if (process.type === \"prefPane\") {\n      return { fileIcon: process.path?.replace(/(.+\\.prefPane)(.+)/, \"$1\") ?? \"\" };\n    }\n\n    if (process.type === \"app\") {\n      return { fileIcon: process.path?.replace(/(.+\\.app)(.+)/, \"$1\") ?? \"\" };\n    }\n\n    return \"/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/ExecutableBinaryIcon.icns\";\n  };\n\n  const killProcess = (process: Process) => {\n    exec(`kill -9 ${process.id}`);\n    setState(state.filter((p) => p.id !== process.id));\n    clearSearchBar({ forceScrollToTop: true });\n    showHUD(`\u2705 Killed ${process.name === \"-\" ? `process ${process.id}` : process.name}`);\n  };\n\n  const copyToClipboardAction = (process: Process) => {\n    return process.path == null ? null : <Action.CopyToClipboard title=\"Copy Path\" content={process.path} />;\n  };\n\n  const subtitleString = (process: Process) => {\n    let subtitle = undefined;\n\n    if (shouldShowPID) {\n      subtitle = process.id;\n    }\n\n    if (shouldShowPath) {\n      subtitle = subtitle ? `${subtitle} - ${process.path}` : process.path;\n    }\n\n    return subtitle;\n  };\n\n  return (\n    <List\n      isLoading={state.length === 0}\n      searchBarPlaceholder=\"Filter by name...\"\n      onSearchTextChange={(query) => setQuery(query)}\n    >\n      {state\n        .filter((process) => {\n          if (query == null) {\n            return true;\n          }\n\n          const nameMatches = process.name.toLowerCase().includes(query.toLowerCase());\n          const pathMatches =\n            process.path?.toLowerCase().match(new RegExp(`.+${query}.*\\\\.[app|framework|prefpane]`, \"ig\")) != null;\n          const pidMatches = process.id.includes(query);\n\n          return nameMatches || (shouldIncludePaths && pathMatches) || (shouldIncludePid && pidMatches);\n        })\n        .sort((a, b) => {\n          // If this flag is true, we bring apps to the top, but only if we have a query.\n          if (query != null && shouldPrioritizeAppsWhenFiltering) {\n            if (a.type === \"app\" && b.type !== \"app\") {\n              return -1;\n            } else if (a.type !== \"app\" && b.type === \"app\") {\n              return 1;\n            }\n          }\n\n          // Otherwise, we leave the order as is.\n          return 0;\n        })\n        .map((process, index) => {\n          const icon = fileIcon(process);\n          return (\n            <List.Item\n              key={index}\n              title={process.name}\n              subtitle={subtitleString(process)}\n              icon={icon}\n              accessories={[{ text: `${process.cpu}%` }]}\n              actions={\n                <ActionPanel>\n                  <ActionPanel.Item title=\"Kill\" icon={Icon.XmarkCircle} onAction={() => killProcess(process)} />\n                  {copyToClipboardAction(process)}\n                  <ActionPanel.Item\n                    title=\"Reload\"\n                    icon={Icon.ArrowClockwise}\n                    shortcut={{ key: \"r\", modifiers: [\"cmd\"] }}\n                    onAction={() => fetchProcesses()}\n                  />\n                </ActionPanel>\n              }\n            />\n          );\n        })}\n    </List>\n  );\n}\n\ntype Process = {\n  id: string;\n  cpu: string;\n  type: \"prefPane\" | \"app\" | \"binary\";\n  path: string | undefined;\n  name: string;\n};\n", "import { useEffect, useRef } from \"react\";\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nconst noop = () => {};\n\nexport function useInterval(callback: () => void, delay: number | null) {\n  const savedCallback = useRef(noop);\n\n  useEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n\n  // Set up the interval.\n  useEffect(() => {\n    savedCallback.current();\n    const refreshEnabled = (delay ?? 0) > 0;\n    if (refreshEnabled) {\n      const interval = Math.max(delay ?? 0, 1000);\n      const id = setInterval(() => savedCallback.current(), interval);\n      return () => clearInterval(id);\n    }\n  }, [delay]);\n}\n\nexport default useInterval;\n"],
  "mappings": "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",
  "names": ["src_exports", "__export", "ProcessList", "__toCommonJS", "import_api", "import_child_process", "import_react", "import_react", "noop", "useInterval", "callback", "delay", "savedCallback", "interval", "id", "use_interval_default", "import_jsx_runtime", "ProcessList", "state", "setState", "query", "setQuery", "preferences", "shouldIncludePaths", "shouldIncludePid", "shouldPrioritizeAppsWhenFiltering", "shouldShowPID", "shouldShowPath", "refreshDuration", "fetchProcesses", "err", "stdout", "processes", "line", "id", "cpu", "path", "name", "isPrefPane", "isApp", "process", "use_interval_default", "fileIcon", "killProcess", "p", "copyToClipboardAction", "subtitleString", "subtitle", "nameMatches", "pathMatches", "pidMatches", "a", "b", "index", "icon"]
}
