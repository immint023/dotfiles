"use strict";var S=Object.create;var C=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var I=Object.getPrototypeOf,T=Object.prototype.hasOwnProperty;var v=(t,e)=>{for(var o in e)C(t,o,{get:e[o],enumerable:!0})},d=(t,e,o,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of B(e))!T.call(t,n)&&n!==o&&C(t,n,{get:()=>e[n],enumerable:!(s=$(e,n))||s.enumerable});return t};var E=(t,e,o)=>(o=t!=null?S(I(t)):{},d(e||!t||!t.__esModule?C(o,"default",{value:t,enumerable:!0}):o,t)),L=t=>d(C({},"__esModule",{value:!0}),t);var U={};v(U,{default:()=>M});module.exports=L(U);var r=require("@raycast/api");var a=require("@raycast/api"),i=require("react");var A=require("child_process"),F=E(require("util"));var p=t=>t.split(`
`).filter(Boolean);var g=require("@raycast/api"),f=require("fs"),w=t=>{let e=(0,g.getPreferenceValues)();if(e.kubectxPath)return e.kubectxPath;let o=[`/usr/local/bin/${t}`,`/opt/homebrew/bin/${t}`],s=t;return o.some(n=>{try{return(0,f.accessSync)(n,f.constants.X_OK),s=n,!0}catch{return!1}}),s},k=()=>(0,g.getPreferenceValues)().kubeConfig||null;var h=F.default.promisify(A.execFile),y=w("kubectx"),P=k();P&&(process.env.KUBECONFIG=P);var O=async()=>{let{stdout:t}=await h(`${y}`,["-c"]);return p(t)[0]},G=async()=>{let{stdout:t}=await h(`${y}`);return p(t)},R=async t=>{await h(`${y}`,[t])},m={getAllContextes:G,getCurrentContext:O,switchContext:R};var _=()=>{let[t,e]=(0,i.useState)(!0),[o,s]=(0,i.useState)([]),[n,l]=(0,i.useState)(),c=async()=>{try{let x=await m.getAllContextes(),b=await m.getCurrentContext();s(x),l(b)}catch{(0,a.showToast)(a.ToastStyle.Failure,"An error occurred","Please make sure you have installed kubectx correctly")}finally{e(!1)}};return(0,i.useEffect)(()=>{c()},[]),{loading:t,contextes:o,currentContext:n,switchContext:async x=>{try{await m.switchContext(x),l(x),await(0,a.closeMainWindow)()}catch{(0,a.showToast)(a.ToastStyle.Failure,"An error occurred")}}}},K=_;var u=require("react/jsx-runtime"),D=()=>{let{contextes:t,switchContext:e,currentContext:o,loading:s}=K(),n=c=>c!==o?{source:r.Icon.Checkmark}:{source:r.Icon.Checkmark,tintColor:r.Color.Green},l=async c=>{await e(c)};return(0,u.jsx)(r.List,{isLoading:s,searchBarPlaceholder:"Filter by title...",children:t.map(c=>(0,u.jsx)(r.List.Item,{title:c,icon:n(c),actions:(0,u.jsxs)(r.ActionPanel,{children:[(0,u.jsx)(r.ActionPanel.Item,{title:`Switch to ${c}`,icon:r.Icon.Checkmark,onAction:()=>l(c)}),(0,u.jsx)(r.CopyToClipboardAction,{content:c})]})},c))})},M=D;0&&(module.exports={});
